--- 
layout: post
title: Couch - data model
published: true
---
<p>Ids - use a combination of flields that uniquely identify one document</p>
<p>updates - keep the updates to any document to the minimum. MVCC does take more disk space. Hence the need for agreesive compaction if disk space is of a concern.</p>
<p>clustering- bigcouch is great! But the tool support is not good, especially to compact shards when there is good amount of data - also it is required that you pick and choose only a section of shards to compact. It would also help to add a bit of scheduling. One more requirement is to check performance of the databases (_stats) across all shards.</p>
<p>attachments- great to serve it directly from couch. Not much useful to peek into the data inside unless inline attachments are used.</p>
<p>map-reduce - incremental indexing is very useful. But test the M/R on a small dataset and get it right before applying it onto the near production dataset. wiki has various tricks about how to get the results out. Be aware of the constraints - the returned values should be contiguous key ranges, hence choose the M/R key carefully.</p>
<p>rereduce - most of the M/R fail to check for rereduce, more so in case of bigcouch where the keys are dispersed across different nodes.</p>
<p>indexing - keep an eye on the growth of indices.</p>
